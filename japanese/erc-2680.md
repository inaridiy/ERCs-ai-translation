---
original: 40e35077ad9387fadfc981b97d4137f6dbf42aefa8f1dc803d100036c72437ea
---

---
eip: 2680
title: Ethereum 2 ウォレットレイアウト
author: Jim McDonald <Jim@mcdee.net>
discussions-to: https://ethereum-magicians.org/t/eip-2680-ethereum-2-wallet-layout/4323
status: 停滞
type: Standards Track
category: ERC
created: 2020-05-29
---

## 簡単な要約

ファイルシステム(例: Amazon S3)やキー/値ストアなどの階層型および非階層型のストレージシステムに対応した、ウォレットストアとキーストアの標準的なレイアウトとネーミング形式。

## 概要

Ethereumウォレットには永続ストレージ上のレイアウトに関する標準がないため、異なるウォレット実装が互換性を持たない。この文書では、Ethereumウォレットストアとキーストアの配置に関する標準を定義し、異なるソフトウェアで同じウォレットやキーを使えるようにする。

## 動機

ウォレットとアカウントの標準的なレイアウトにより、バリデーターの相互運用性が向上する。これはユーザーにとって有益で、ファイルの移動なしに1つのバリデーターソフトウェアから別のものに(そして戻る)移行できるようになる。これは重要で、キーを含むファイルを移動すると、それらを削除したり複製したりして、資金にアクセスできなくなる危険性があるためである。

## 仕様

ウォレットには4つの要素があり、それらを以下で定義する。

### ベースロケーション
ベースロケーションは既知のものでなければならず、事前に定義されているか、ストレージシステムの接続パラメーターで定義される。

ファイルシステムの場合、異なるオペレーティングシステムのベースロケーションは以下の通りである:

  - Windows: `%APPDATA%\ethereum2\wallets`
  - MacOSX: `${HOME}/Library/Application Support/ethereum2/wallets`
  - Linux: `${HOME}/.config/ethereum2/wallets`

他の階層型ストア(例: Amazon S3)の場合、ベースロケーションは文字列 "Ethereum 2 wallet:" にストアの識別子を連結した文字列のSHA-256ハッシュ値の小文字16進数表記でなければならない。例えば、ユーザーのAmazon S3アカウントのIDが "AbC0438EB" の場合:

  - 文字列は `Ethereum 2 wallet:AbC0438EB`
  - SHA-256ハッシュ値は `0x991ec14a8d13836b10d8c3039c9e30876491cb8aa9c9c16967578afc815c9229`
  - ベースロケーションは文字列 `991ec14a8d13836b10d8c3039c9e30876491cb8aa9c9c16967578afc815c9229`

非階層型ストアの場合、ベースロケーションはない。

### ウォレットコンテナ
ウォレットコンテナには、ウォレットストアとそれに関連するキーストアが含まれる。

ウォレットコンテナは、ウォレットのUUIDで識別される。[RFC 4122 セクション3](https://tools.ietf.org/html/rfc4122#section-3)に定義された構文に従う文字列でなければならない。

### ウォレットストア
ウォレットストア要素にはウォレットストアが含まれ、ウォレットコンテナ内に保持される。ウォレットのUUIDで識別される。[RFC 4122 セクション3](https://tools.ietf.org/html/rfc4122#section-3)に定義された構文に従う文字列でなければならない。

### キーストア
キーストア要素にはキーのキーストアが含まれ、ウォレットコンテナ内に保持される。キーのUUIDで識別される。[RFC 4122 セクション3](https://tools.ietf.org/html/rfc4122#section-3)に定義された構文に従う文字列でなければならない。

## 階層型ストアの例
階層型ストアは、情報を保存および整理する一般的な方法である。最も一般的な例はファイルシステムですが、Amazon S3などのオブジェクトベースのストアも階層的な命名を提供する。

ウォレットUUID `1f031fff-c51d-44fc-8baf-d6b304cb70a7`、キーUUID `1302106c-8441-4e2e-b687-6c77f49fc624`および `4a320100-83fd-4db7-8126-6d6d205ba834`を持つサンプルウォレットの場合、以下のようなレイアウトになる:

```
- 1f031fff-c51d-44fc-8baf-d6b304cb70a7
+- 1302106c-8441-4e2e-b687-6c77f49fc624
+- 1f031fff-c51d-44fc-8baf-d6b304cb70a7
+- 4a320100-83fd-4db7-8126-6d6d205ba834
```

### 非階層型ストアの例
非階層型ストアでは、ウォレットUUIDとキーUUIDを `:` 文字で連結した簡略化されたアプローチを使う。上記と同じウォレットとキーUUIDを使うと、以下のようなキーが得られる:

```
1f031fff-c51d-44fc-8baf-d6b304cb70a7:1302106c-8441-4e2e-b687-6c77f49fc624
1f031fff-c51d-44fc-8baf-d6b304cb70a7:1f031fff-c51d-44fc-8baf-d6b304cb70a7
1f031fff-c51d-44fc-8baf-d6b304cb70a7:4a320100-83fd-4db7-8126-6d6d205ba834
```

### 同時書き込みアクセスの保護
TBD

### ウォレットの反復処理
階層型ストアや反復可能な非階層型ストアの場合、ルートコンテナ内のファイルを反復処理することでウォレットを反復処理できる。

実装者は、ベースロケーションにインデックスを含めてもよい。その場合、以下の「インデックスフォーマット」セクションで指定された構造に従わなければならない。

### アカウントの反復処理
階層型ストアの場合、ウォレットコンテナ内のファイルを反復処理することでアカウントを反復処理できる。

実装者は、ウォレットコンテナ内でそのウォレット内のアカウントのインデックスを含めてもよい。その場合、以下の「インデックスフォーマット」セクションで指定された構造に従わなければならない。

### インデックスフォーマット
インデックスフォーマットは、ウォレットとアカウントの両方で同じ標準的なJSONスキーマに従う。

```json
{
    "type": "array",
    "items": {
        "type": "object",
        "properties": {
            "uuid": {
                "type": "string"
            },
            "name": {
                "type": "string"
            }
        },
        "required": [
            "uuid",
            "name"
        ]
    }
}
```

インデックスは必ず "index" という識別子を使用しなければならない。

公開鍵はインデックスに保存してはならない。

## 根拠

ウォレットストアに関する標準は、キーストアの標準と同様に、ウォレット間の互換性を高め、ウォレットとキーの簡単な交換を可能にする。

## 実装

ファイルシステムレイアウトのGoによる実装は[https://github.com/wealdtech/go-eth2-wallet-filesystem](https://github.com/wealdtech/go-eth2-wallet-filesystem)にある。

Amazon S3レイアウトのGoによる実装は[https://github.com/wealdtech/go-eth2-wallet-s3](https://github.com/wealdtech/go-eth2-wallet-s3)にある。

## セキュリティ上の考慮事項

ウォレットストアの場所は各ユーザーの個人領域内に定義されているため、情報の偶発的な露出の可能性が低減される。ただし、パーミッションが世界読み取り可能に設定されている可能性はあり、このEIPを実装するアプリケーションは、関連するユーザーのみがこの情報にアクセスできるように、パーミッションの設定と再設定を試みるべきである。

ウォレットとキーストアの名前はUUIDであるため、メタデータからデータが漏洩することはない。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)で放棄されています。