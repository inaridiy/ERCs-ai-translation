---
original: 0deaaa93dd00c64f69b7531aa4ee19318fa72628b0d550476fa82a4f8345e9bd
---

---
eip: 7682
title: 補助的資金機能
description: ウォレットが追加の資金にアクセスできることを示す機能。
author: Lukas Rosario (@lukasrosario), Wilson Cusack (@wilsoncusack)
discussions-to: https://ethereum-magicians.org/t/erc-7682-auxiliary-funds-capability/19599
status: Draft
type: Standards Track
category: ERC
created: 2024-04-09
requires: 5792
---

## 概要

[EIP-5792](./eip-5792.md)に準拠した機能で、ウォレットがアプリに対してアドレスのオンチェーンの残高では説明できない追加の資金にアクセスできることを示すことができます。

ウォレットが補助的な資金にアクセスできる能力は、[EIP-5792](./eip-5792.md) `wallet_getCapabilities`リクエストへの応答の一部として、アプリに伝えられます。以下の標準では、これらの補助的な資金の出所を特定していませんが、いくつかの例は以下の通りです:

- オフチェーンのソースからの資金をオンランプし、必要に応じて使用できるようにする
- 複数のアカウントを管理するウォレットで、それらのアカウントにある資産をアプリが要求したトランザクションを送信する前に必要なアカウントに転送できる

## 動機

多くのアプリケーションは、ユーザーが何らかのアクションを完了する前に、ユーザーの残高を確認します。例えば、ユーザーがデックスでトークンをスワップしたい場合、デックスはユーザーがそのトークン量をアドレスに持っていないことを確認すると、通常ユーザーがそのアクションを行うことを阻止します。しかし、より高度なウォレットには、ユーザーが他のソースから資金にアクセスできる機能があります。ウォレットは、これらのより高度なウォレットを使用するユーザーが残高チェックによってブロックされないように、アプリにそれらの追加の資金へのアクセスを伝える方法が必要です。

## 仕様

新しい[EIP-5792](./eip-5792.md)ウォレット機能が定義されています。

### ウォレットの実装

この仕様に準拠するには、補助的な資金にアクセスできることを示したいウォレットは、アクセスできる各チェーンについて、`wallet_getCapabilities`コールに対する応答で、`auxiliaryFunds`オブジェクトの`supported`フィールドを`true`に設定する必要があります。

ウォレットは、追加でアクセスできる資産を`assets`フィールドで指定することもできます。これは、追加アクセスできる資産のアドレスの配列にマッピングされます。ウォレットがこのオプションの資産配列を返さない場合、アプリケーションはウォレットが任意の資産に追加アクセスできると想定する必要があります。

この仕様では、補助的な資金の出所に制限を設けていません。

この仕様では、チェーンのネイティブアセット(例えばイーサリアムのイーサ)は、[EIP-7528](./eip-7528)で指定されている通り、"0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE"で表す必要があります。

#### `wallet_getCapabilities`レスポンス仕様

```typescript
type AuxiliaryFundsCapability = {
  supported: boolean;
  assets?: `0x${string}`[];
}
```

##### `wallet_getCapabilities`レスポンス例

```json
{
  "0x2105": {
    "auxiliaryFunds": {
      "supported": true,
      "assets": [
        "0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",
        "0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913"
      ]
    }
  },
  "0x14A34": {
    "auxiliaryFunds": {
      "supported": true,
      "assets": [
        "0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE",
        "0x036CbD53842c5426634e7929541eC2318f3dCF7e"
      ]
    }
  }
}
```

### アプリの実装

アプリが、接続されたウォレットが`wallet_getCapabilities`レスポンスの`auxiliaryFunds`機能を通じて補助的な資金にアクセスできることを確認した場合、アプリはユーザーの資産残高チェックに基づいてユーザーのアクションをブロックしてはいけません。

## 根拠

### 代替案

#### 高度な残高取得

検討した別の案は、アプリが補助的な残高を取得する方法を定義することです。これは、例えば`auxiliaryFunds`機能の一部としてURLを提供し、アプリがそれを使って補助的な残高情報を取得できるようにするなどの方法が考えられます。しかし、ユーザーのアクションをブロックしないことを示すブール値があれば十分だと判断し、アプリの実装負荷を最小限に抑えることにしました。

この機能の形式は、アプリがより多くの機能を必要と感じた場合に、より高度な拡張が可能になっています。

## セキュリティ上の考慮事項

アプリは、補助的な資金の出所について何も仮定してはいけません。アプリのスマートコントラクトは、今日と同様に、トランザクション処理時にオンチェーンの適切な残高チェックを行う必要があります。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)で放棄されています。