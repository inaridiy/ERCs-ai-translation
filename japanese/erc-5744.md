---
original: 771660e1a63f42d4588388ef4550c3faf4003a2e56ddaa964114a4f5a2d34764
---

---
eip: 5744
title: 潜在的な代替可能トークン
description: 一定期間後に代替可能になるトークンのためのインターフェース。
author: Cozy Finance (@cozyfinance), Tony Sheng (@tonysheng), Matt Solomon (@mds1), David Laprade (@davidlaprade), Payom Dousti (@payomdousti), Chad Fleming (@chad-js), Franz Chen (@Dendrimer)
discussions-to: https://ethereum-magicians.org/t/eip-5744-latent-fungible-token/11111
status: 停滞
type: Standards Track
category: ERC
created: 2022-09-29
requires: 20, 2612
---

## 概要

以下の規格は[EIP-20](./eip-20.md)の拡張であり、トークンが一定の非代替期間の後に代替可能になることを可能にします。
鋳造後、トークンは成熟するまで非代替的です。
成熟すると、代替可能になり、標準的なEIP-20トークンと同様に転送、取引、使用することができます。

## 動機

使用例には以下のようなものがあります:

- 特定の日付または条件が満たされるまで有効にならない受領トークン。例えば、これを使ってレンディングプロトコルの最小預金期間を強制することができます。
- ベスティング期間が経過するまで転送や使用ができないベスティングトークン。

## 仕様

すべての潜在的な代替可能トークンはEIP-20を実装して、トークンを表現しなければなりません。
`balanceOf`と`totalSupply`は、成熟した代替可能トークンだけでなく、すべてのトークンの量を返します。
新しいメソッド`balanceOfMatured`をABIに追加する必要があります。
このメソッドは、指定のアドレスの成熟したトークンの残高を返します:

```solidity
function balanceOfMatured(address user) external view returns (uint256);
```

さらに、`getMints`という新しいメソッドを追加する必要があります。このメソッドは、指定のアドレスのすべての鋳造メタデータを返します:

```solidity
struct MintMetadata {
  // 鋳造されたトークンの量。
  uint256 amount;
  // 鋳造のタイムスタンプ(秒単位)。
  uint256 time;
  // これらのトークンが成熟し、代替可能になるまでの遅延(秒単位)。遅延が不明な場合(例えば、単に経過時間以外の要因に依存する場合)、この値は`type(uint256).max`でなければなりません。
  uint256 delay;
}

function getMints(address user) external view returns (MintMetadata[] memory);
```

実装では、上記のメタデータパラメータを`uint256`として保存する必要はなく、`uint256`として返すだけでよいことに注意してください。

`mints`という追加のメソッドを追加してもかまいません。
このメソッドは、IDに基づいて鋳造メタデータを返します:

```solidity
function mints(address user, uint256 id) external view returns (MintMetadata memory);
```

IDは規定されていません。配列のインデックスであったり、他の方法で生成されたりする可能性があります。

`transfer`と`transferFrom`メソッドは、成熟していないトークンの転送を拒否するように変更してもかまいません。
同様に、トークンの焼却を行うメソッドも、成熟していないトークンの焼却を拒否するように変更してもかまいません。

すべての潜在的な代替可能トークンは、EIP-20の任意のメタデータ拡張を実装しなければなりません。
`name`と`symbol`関数は、基礎となるトークンの`name`と`symbol`を何らかの形で反映しなければなりません。

## 根拠

`mints`メソッドはオプションです。IDはオプションだからです。ユーザーが最大1つの鋳造しか持たない、ベスティングのようなユースケースでは、IDは必要ありません。

同様に、ベスティングのユースケースでは、成熟するまでトークンの転送を禁止したいかもしれませんが、最小預金期間を持つレンディング受領トークンの場合は、常に転送をサポートしたいかもしれません。

ユーザーが保有する鋳造の数が非常に多く、1回の`eth_call`で全てを返すのが現実的ではない可能性があります。
これはまれなケースなので、仕様に含めていません。
特定のユースケースでこれが起こりそうな場合、実装者は`getMints(address user, uint256 startId, uint256 endId)`のように、鋳造の一部を返すオルタナティブなメソッドを実装することができます。
ただし、IDが連続していない場合、別の署名が必要になるため、これも仕様に含めていません。

## 下位互換性

この提案はEIP-20規格と完全に下位互換性があり、他の規格との既知の互換性の問題はありません。

## セキュリティ上の考慮事項

多数の鋳造を反復処理するのは推奨されません。これは非常に高価であり、ブロックガスリミットを超えてリバートする可能性があるため、プロトコルやユーザーの操作が停止する可能性があります。これを緩和する方法はいくつかありますが、具体的な方法は実装によって異なります。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)により放棄されています。