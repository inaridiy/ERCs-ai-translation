---
original: 72708a3240068eabbbf4b3849288d7f9bb57cee535dd869646c2a555c2c5819c
---

---
eip: 2334
title: BLS12-381 決定論的アカウントヒエラルキー
author: Carl Beekhuizen (@CarlBeek) <carl@ethereum.org>
discussions-to: https://github.com/ethereum/EIPs/issues/2338
status: 停滞
type: Standards Track
category: ERC
created: 2019-09-30
requires: 2333
---

## 簡単な要約

このEIPは、キーツリー内の特定のキーまたはキーファミリーの目的を定義します。[EIP-2333](./eip-2333.md)と組み合わせることで、シードと目的の知識があれば、キーペアを決定することができます。

## 概要

[EIP-2333](./eip-2333.md)によって生成されたキーを特定の目的に割り当てるための標準です。`path`と呼ばれる文字列を定義し、これを解析することで[EIP-2333](./eip-2333.md)が生成するキーツリーを移動するためのインデックスを取得できます。

## 目的に関する注意

この仕様は、Ethereum 2.0の標準だけでなく、[BLS12-381上のBLS署名](https://datatracker.ietf.org/doc/draft-irtf-cfrg-bls-signature/)を採用したより広いコミュニティでも採用されることを意図しています。したがって、Ethereumに特有のニーズだけでなく、より広範なニーズも考慮する必要があります。これらの考慮事項の一環として、将来的にはより中立的なリポジトリに移行することを意図しています。

## 動機

Ethereum 2.0およびその他多くのプロジェクトでは、[IETF提案標準](https://datatracker.ietf.org/doc/draft-irtf-cfrg-bls-signature/)であるBLS12-381上のBLS署名を使用します。この新しいスキームには新しいキー派生メカニズムが必要で、これは[EIP-2333](./eip-2333.md)で確立されています。この新しいスキームは、[BIP44](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki)の現在の形式と互換性がありません。これは、専用のハードキーの使用、レベルあたりのキーの増加、[BIP32](https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki)を使用したキー派生の不使用が原因です。したがって、[EIP-2333](./eip-2333.md)キーツリーを移動するための新しい*パス*を確立する必要があります。

このEIPで指定されたパス構造は、[BIP44](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki)よりも一般的であり、Ethereum 1.0内で使用されている4つの異なるタイプのウォレットパスを生み出した[UTXO中心の機能](https://github.com/ethereum/EIPs/issues/84#issuecomment-292324521)を持っていません。これにより、(草案の)[EIP-600](./eip-600.md)と[EIP-601](./eip-601.md)が生まれました。

## 仕様

### パス

キーツリーを移動するパスは、整数(兄弟インデックスを示す)で定義され、`/`で区切られ、祖先関係を示します。パスには4つのレベル(マスターノードを含む)があり、少なくとも4つ(マスターノードを含む5つ)を使用する必要があります。

```text
m / purpose / coin_type /  account / use
```

#### 表記

パス内で使用される表記は、[EIP-2333](./eip-2333.md)で指定されていますが、便宜上ここでも要約します。

* `m` ツリーのマスターノード(ルート)を示します
* `/` 深さを区切るものであり、`i / j`は`j`が`i`の子であることを示します

### 目的

`purpose`は`12381`に設定されており、これは新しい曲線(BLS12-381)の名前です。この標準に準拠するには、[EIP-2333](./eip-2333.md)をKDFとして実装する必要があり、したがって`purpose`は`12381`以外は使用できません。

### コインタイプ

`coin_type`は個々のコインの番号を反映しており、異なるチェーンで使用されるキーを区別するための手段として機能します。

### アカウント

`account`は、ユーザーが必要に応じて異なる目的のキーセットを持つことができるようにする機能を提供します。このレベルでは、単一のユーザーの異なるアカウントを実装する必要があります。

### 用途

このレベルは、セキュリティ上の理由から関連しつつ分離されるべき、単一のアカウントの多くの用途に対応するキーのセットを提供することを目的としています。このツリーレベルをサポートすることは必須ですが、多くの用途では`0`のままになります。

### Eth2固有のパラメータ

#### コインタイプ

Ethereum 2.0のBLS12-381キーに使用されるコインタイプは`3600`です。

#### バリデーターキー

各Eth2バリデーターには2つのキーがあり、1つは引き出しと転送用(「引き出しキー」と呼ばれる)、もう1つはバリデーターとしての義務を果たすために使用されます(以下「署名キー」と呼びます)。

引き出しキーのパスは`m/12381/3600/i/0`で、`i`はバリデーターキーの`i`番目のセットを示します。

署名キーのパスは`m/12381/3600/i/0/0`で、ここでも`i`はバリデーターキーの`i`番目のセットを示します。別の言い方をすると、署名キーは対応する引き出しキーの`0`番目の子孫です。

**注意:** 上記のキーパスの説明が特定の使用例(秘密共有または管理付きのバリデーターなど)で実現可能でない場合は、影響を受けるキーを省略し、別の方法で派生させることができます。このEIPの実装では、可能な限り、使用例に適したキーを使用するよう努める必要があります(例えば、管理付きのステーキングの場合、ユーザーが行う預金については、この標準に従って引き出しキーを使用しますが、サービスプロバイダーが署名キーを派生させる方法には影響しません)。

## 根拠

`purpose`、`coin_type`、`account`は[BIP43](https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki)と[BIP44](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki)で広く採用されている用語であり、これらの用語とその意味を再利用することが適切です。

KDFとパスが互換性がないため、`purpose`は これらの標準とは区別する必要があり、`12381`は明らかな選択肢です。

`account`により、ユーザーの活動を異なるカテゴリーに分離できるため、ユーザーが必要に応じて自分の関心事を分離できます。

`use`は通常、アプリケーションレベルで決定され、非重複のユースケースに対して個別のキーを提供します。

### Eth2固有のパラメータ

Eth2キーとEth1キーを確実に区別するために、新しいコインタイプが選択されています。Eth1のETHとEth2のETHの区別は微妙ですが、それらは別個のエンティティであり、コイン名のみでコインを区別するサービス(例えば[ENSのマルチチェーンアドレス解決](./eip-2304.md))もあります。`3600`は特に選択されており、それはEth1の`coin_type`(`3600==60^2`)の2乗であるため、それがEtherの通貨の2番目のインスタンスであることを示しています。

バリデーターが別々の署名キーと引き出しキーを持つ主な理由は、Eth2内のアクションの異なるセキュリティ上の懸念に対応するためです。署名キーはバリデータークライアントに渡され、バリデーターの要件に従ってメッセージに署名します。つまり、これは「ホットキー」です。このキーが侵害された場合、最悪の場合は切り捨て可能なメッセージが署名されるだけで、バリデーターが切り捨てられ、強制的に退出されます。引き出しキーは、バリデーターが検証以外の行動を行う際にのみ必要で、そのバリデーターの全資金にアクセスできます。したがって、引き出しキーにはより高いセキュリティ上の懸念があり、「コールドキー」として扱う必要があります。署名キーを引き出しキーの子孫にすることで、引き出しキーを安全に保管すれば、必要に応じて署名キーを復元できます。

## 下位互換性

[BIP43](https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki)と[BIP44](https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki)は、Ethereum 1.0内でこの目的に広く使用されている標準ですが、まだ`Accepted`されていません。[EIP-2333](./eip-2333.md)内の新しいKDFの使用により、新しいパス標準が必要になります。このEIPはこれを実装しますが、わずかな変更があります。

`purpose`が`12381`のパスではハードキーがサポートされていないため、`'`文字は無効です。

## 著作権

著作権およびそれに関連する権利は[CC0](../LICENSE.md)によって放棄されています。