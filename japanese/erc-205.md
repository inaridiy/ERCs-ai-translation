---
original: 4ababae9efe8089012f9a867c1b42ebe0b66147ddcb39e75c269436b4fcd3fd6
---

---
eip: 205
title: ENS向けのコントラクトABIサポート
author: Nick Johnson <nick@ethereum.org>
type: Standards Track
category: ERC
status: Stagnant
created: 2017-02-06
requires: 137, 181
---

## 簡単な要約
このEIPは、呼び出し側がコントラクトインターフェースを簡単に検索できるよう、ENSにABI定義を保存するメカニズムを提案しています。

## 概要
ABIは、ほとんどのコントラクトと対話するために重要なメタデータです。現在、それらは通常アウトオブバンドで提供されており、特に一回限りの場合や、ABIが時間とともに更新される場合に、コントラクトと対話する際の追加の負担となっています。ABIのサイズが小さいため、ENSに保存することで、同じプロセスでネーム検索とABI検出を行うことができます。

ABIは通常かなり小さいです。私たちが見つけた最大のABIは、DAOのABIで、非圧縮JSONが9450バイト、非圧縮CBORが6920バイト、zlib圧縮JSONが1128バイトです。CBORエンコーディングでは、ABIに広く使用されている重複する文字列を排除するCBOR拡張を使用することで、さらに圧縮が可能です。しかし、ほとんどのABIは、非圧縮JSONで数百バイトしかありません。

このEIPは、コントラクトABIを取得するためのレゾルバープロファイルを定義し、さまざまなアプリケーションでABIを保存するためのエンコーディング規格を定義しています。これにより、ユーザーは、コンパクトさや、オンチェーンアクセスなどの他の要件に基づいて、さまざまな表現を選択できます。

## 仕様
### ABIエンコーディング
オンチェーンサイズと可読性のトレードオフを許容するために、いくつかのABIエンコーディングが定義されています。各ABIエンコーディングは、唯一のビットが設定された一意の定数で定義されており、256個の一意のエンコーディングを単一のuintで指定できます。

現在認識されているエンコーディングは以下の通りです:

| ID | 説明                  |
|----|----------------------|
| 1  | JSON                 |
| 2  | zlib圧縮JSON         |
| 4  | CBOR                 |
| 8  | URI                  |

このテーブルは、EIPプロセスを通じて将来拡張される可能性があります。

エンコーディングタイプ1は、非圧縮のプレーンテキストJSONを指定します。これは、ABIが通常エンコーディングされる標準フォーマットですが、最も大きく、オンチェーンでは解析しにくいです。

エンコーディングタイプ2は、zlib圧縮JSONを指定します。これは非圧縮JSONよりも大幅に小さく、オフチェーンでも簡単に解凍できます。ただし、オンチェーンのコンシューマーが使用するのは実用的ではありません。

エンコーディングタイプ4は[CBOR](https://cbor.io/)です。CBORは、JSONのスーパーセットであるバイナリエンコーディング形式で、より小さく、EVM などの制限された環境でも解析しやすくなっています。CBORをサポートするコンシューマーは、エンコーディングサイズをさらに大幅に削減する[stringref拡張](http://cbor.schmorp.de/stringref)もサポートすることが強く推奨されます。

エンコーディングタイプ8は、ABIが指定されたURIの場所にあることを示します。これは、サポートされる形式の中で最も小さくなりますが、実装者に外部依存関係が追加されます。指定されたURIには任意のスキーマを使用できますが、HTTP、IPFS、Swarmが最も一般的に使用されると予想されます。

### レゾルバープロファイル
新しいレゾルバーインターフェースが定義されており、以下のメソッドで構成されています:

    function ABI(bytes32 node, uint256 contentType) constant returns (uint256, bytes);

このインターフェースのIDは0x2203ab56です。

contentTypeはビットフィールドで、呼び出し側が受け入れるすべてのエンコーディングタイプのビットごとのORです。このインターフェースを実装するレゾルバーは、要求されたフォーマットの1つでエンコーディングされたABIを返す必要があります。要求されたフォーマットのいずれもサポートしていない場合は、`(0, "")`を返す必要があります。

`abi`レゾルバープロファイルは、順方向レコードと逆引きレコードの両方で有効です。

### ABI検索プロセス
ENS名に基づいてABIを取得しようとする際、実装者は最初にその名前自体でABI検索を試みる必要があります。その検索で結果が得られない場合は、その名前が解決されるEthereum アドレスの逆引き検索を試みる必要があります。

実装者は、実用的な範囲で可能な限り多くのABIエンコーディング形式をサポートする必要があります。

## 根拠
オンチェーンでABIを保存することで、SwarmやHTTPアクセスなどの追加の依存関係を導入する必要がなくなります。ABIは通常かなり小さいため、多くの場合これは価値のある取引だと考えています。

2段階の解決プロセスにより、同じコントラクトに対して異なる名前で異なるABIを提供できるようになります。たとえば、一部の呼び出し側に最小限のABIを提供したい場合や、自身のABIを指定していないコントラクトにABIを指定する場合などです。逆引きレコードでABIを検索することで、コントラクト自体が正式なABIを指定できるようになり、同じコントラクトを参照する複数の名前の重複を防ぐことができます。

## 著作権
著作権およびそれに関連する権利は[CC0](../LICENSE.md)で放棄されています。